# 双端队列

https://juejin.cn/post/6844904181002665992

这篇文章详细地介绍了 ArrayDeque 的实现原理和使用方式。ArrayDeque 是一个基于数组实现的双端队列，它允许我们在队列的两端进行元素的插入和删除操作。

以下是关于 ArrayDeque 的主要内容总结：

1.  **数据结构**：ArrayDeque 使用一个数组来存储元素。它有两个主要的属性，`head` 和 `tail`，分别表示队列头部和尾部的索引。
    
2.  **双端队列操作**：ArrayDeque 提供了一系列的方法来在队列的两端进行元素的插入和删除操作。例如，`addFirst(E e)` 和 `addLast(E e)` 方法分别在队列的头部和尾部添加元素，而 `pollFirst()` 和 `pollLast()` 方法则分别从队列的头部和尾部删除元素。
    
3.  **数组扩容**：当数组容量不足时，ArrayDeque 会自动进行扩容。扩容的策略是将当前的容量扩大两倍。这是通过 `doubleCapacity()` 方法实现的。
    
4.  **数组索引计算**：ArrayDeque 的一个重要特性是，它的头部和尾部索引是循环的。这意味着当头部或尾部索引超过数组长度时，它会从数组的另一端开始。这是通过对数组长度进行位运算实现的。
    
5.  **队列和堆栈操作**：除了双端队列的操作外，ArrayDeque 还提供了一系列的队列和堆栈操作。例如，`offer(E e)` 和 `poll()` 方法分别实现了队列的入队和出队操作，而 `push(E e)` 和 `pop()` 方法则实现了堆栈的压栈和弹栈操作。
    

> ArrayDeque 是一个高效且灵活的数据结构，它通过数组和循环索引的方式实现了双端队列，队列和堆栈的操作。


### ArrayDeque的长度是2的指数倍吗? 为什么

是的，ArrayDeque 的长度是 2 的指数倍。这是因为 ArrayDeque 使用位运算来计算索引，这样可以提高计算效率。

在 ArrayDeque 中，当需要增加或减少头部和尾部的索引时，它会使用位运算（例如 `(head - 1) & (elements.length - 1)` 或 `(tail + 1) & (elements.length - 1)`）。这些位运算的前提是数组的长度是 2 的指数倍，这样才能保证运算结果的正确性。

此外，当数组的长度是 2 的指数倍时，数组的扩容也会变得更加高效。因为扩容时只需要将当前的容量左移一位（即乘以 2），而不需要进行复杂的乘法运算。

所以，ArrayDeque 的长度是 2 的指数倍，这是为了提高索引计算和数组扩容的效率。